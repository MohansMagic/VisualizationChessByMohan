<div class="app-root">
  <div class="background-overlay"></div>
  <div class="main-content">

    <!-- User names and timers -->
    <div class="timers-row">
      <div class="timer-block white-block" [class.active]="activeColor === 'w'">
        <input class="name-input" [(ngModel)]="whiteName" />
        <div class="timer" [class.timeup]="timeUp==='w'">
          {{ timeUp === 'w' ? "Time's up!" : formatTime(whiteTime) }}
        </div>
      </div>
      <div class="timer-block black-block" [class.active]="activeColor === 'b'">
        <input class="name-input" [(ngModel)]="blackName" />
        <div class="timer" [class.timeup]="timeUp==='b'">
          {{ timeUp === 'b' ? "Time's up!" : formatTime(blackTime) }}
        </div>
      </div>
    </div>

    <div class="chessboard-with-ranks">
      <div class="board-rows">
        <!-- Top file labels -->
        <div class="board-labels-edge board-labels-edge-top">
          <span class="edge-label" *ngFor="let j of files">{{ j }}</span>
        </div>
        <!-- Board rows with rank labels on left and right -->
        <div *ngFor="let row of board; let i = index" class="board-row-with-edge-labels">
          <span class="edge-label">{{ 8 - i }}</span>
          <div class="board-row">
            <div
              *ngFor="let piece of row; let j = index"
              class="square"
              [ngClass]="[
                (i + j) % 2 === 0 ? 'beige' : 'brown',
                selectedSquare === getSquareName(i, j) ? 'selected' : ''
              ]"
              (click)="onSquareClick(i, j)">
              <img *ngIf="piece && !blindfold" [src]="getPieceUrl(piece)" width="32" height="32" />
            </div>
          </div>
          <span class="edge-label">{{ 8 - i }}</span>
        </div>
        <!-- Bottom file labels -->
        <div class="board-labels-edge board-labels-edge-bottom">
          <span class="edge-label" *ngFor="let j of files">{{ j }}</span>
        </div>
      </div>
    </div>

    <!-- Controls -->
    <div class="controls">
      <button (click)="blindfold = !blindfold">
        {{ blindfold ? 'Show Pieces' : 'Blindfold Mode' }}
      </button>
      <button (click)="reset()">
        Reset
      </button>
      <button (click)="startListening()">
        ðŸŽ¤ Speak Move
      </button>
      <span *ngIf="isListening" class="listening-indicator">Listening...</span>
    </div>

    <div class="move-input-row">
      <input [(ngModel)]="moveInput" placeholder="e4, Nf3, exd5, e2e4, ..." />
      <button (click)="movePiece(moveInput)">Move</button>
      <span class="move-error" *ngIf="moveError">{{ moveError }}</span>
    </div>

    <div class="info-section">
      <div>
        <strong>FEN:</strong>
        <div class="info-mono">{{ fen }}</div>
      </div>
      <div>
        <strong>PGN:</strong>
        <div class="info-mono">{{ pgn }}</div>
      </div>
      <div>
        <strong>Move History:</strong>
        <ol>
          <li *ngFor="let move of moveHistory">{{ move }}</li>
        </ol>
      </div>
    </div>
  </div>
</div>
